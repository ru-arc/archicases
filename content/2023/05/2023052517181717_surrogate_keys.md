---
title: "Surrogate Keys"
date: 2023-05-25T18:18:17:17+03:00
description: ""
tags: ["db", "db_keys"]
ShowToc: true
ShowBreadCrumbs: true
draft: false
---
# Суррогатные ключи в базах

## Описание 

Есть 4 независимых установки со своими базами. В каждой есть свои собственные auto_increment ключи.

Запускаем CDC-решение на дебезиуме.
Нужно слить из 4 независимых баз данные в одну и ключи в этих базах пересекаются, что ломает весь процесс.

Какие существуют варианты решения такой проблемы?

## Предложенные решения

## Решение 1

Если таблицы пересекаются, то в пересекающихся таблицах вводится суррогатный ключ и фиксируется источник каждой строки. 
Получается композитный индекс <key, shard>.

## Решение 2

Вводится новый ключ, при этом «бывший» ключ будет «обычным» атрибутом и перестанет играть роль ключа.
Для нового ключа можно задать префикс по системе источника <source_newKey>

### Особенность решений
Если не требуется выборки по системам-источникам, то признак системы-источника можно не хранить и тогда решение 
упрощается до ввода нового суррогатного ключа без префикса.

### Обсуждение

https://t.me/archicases/1716/1717
