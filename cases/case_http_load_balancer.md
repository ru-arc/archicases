# Выбор HTTP-балансировщика нагрузки

## Описание

Есть существующее решение. В нем внешние системы общаются с инстансами приложения напрямую (p2p). Инстансы приложения иногда падают. Требуется выбрать балансировщик нагрузки и поставить его между внешними системами и внутреними приложенниями (см изображение).

Вопросы:
1. На что обратить внимание при выборе балансировщика?
2. Какой балансировщик посоветуете под такую архитектуру и почему?
3. Какой точно не посоветуете под такую архитектуру и почему?

Внешние системы – они совсем внешние, это внешние партнеры, например.


## Дайджест

В ходе обсуждения был сформулирован перечень дополнительных вопросов, играющих существенную роль в выборе балансировщика нагрзуки, курсивом – ответы от автора кейса:

1) Какая нагрузка ожидается? 100rps, 1000rps, 100000rps
*6000+ rps*

2) Сколько длится обработка запроса (10ms, 100ms, 1000ms, 10000ms)
*10ms, ответ давать не требуется*

3) Кто (внешние системы или балансировщик) отвечают за повтор запросов при сбоях?
*Внешние системы*

4) Где все развернуто (публичное облако, свое облако, не облако)?
*не облако*

5) Нужна ли балансировка между ДЦ или все внутри ДЦ?
*это два разных решения, нужны оба, но можно рассмотреть по отдельности, так как живут они отдельно*

6) Есть ли какие-то дополнительные правила на балансировке (sticky sessions, разметка для канарейки и т.п.)?
*нет, только дополнение запроса айпишником отправителя*

7) Нужна ли доп.функциональность на балансировщике - авторизация, аутентификация, терминирование tls, биллинг, бюджетирование и так далее
*нет, аутентификация идет по login/pass, для пары login/pass сверяется ip-адрес*

8) Какие алгоритмы балансировки нужны - round-robin, взвешенная, на основе скорости отклика?
*пока не ясно, надо экспериментировать, сейчас цель - поставить между партнерами и внутренними системами прослойку с возможностью балансировки максимально без усилий (без самописов и изменения существующих систем)*


